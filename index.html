<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Hybrid AR Business Card</title>

		<!-- A-Frame + MindAR for browser AR -->
		<script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>

		<!-- Model Viewer for device AR fallback -->
		<script
			type="module"
			src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"
		></script>

		<style>
			body {
				margin: 0;
				overflow: hidden;
			}

			/* Social icons overlay */
			#socialContainer {
				position: absolute;
				bottom: 10%;
				left: 50%;
				transform: translateX(-50%);
				display: flex;
				flex-direction: column;
				gap: 10px;
				padding: 10px 15px;
				border-radius: 15px;
				background-color: rgba(0, 0, 0, 0.4);
				backdrop-filter: blur(6px);
				opacity: 0;
				transition: opacity 0.3s ease;
				z-index: 10;
				align-items: center;
			}
			#socialContainer.show {
				opacity: 1;
			}

			.row {
				display: flex;
				gap: 10px;
			}
			.social-icon {
				width: 50px;
				height: 50px;
				cursor: pointer;
				transition: transform 0.2s ease, opacity 0.2s ease;
			}
			.social-icon:hover {
				transform: scale(1.15);
				opacity: 0.9;
			}

			/* Model Viewer AR button */
			#arButton {
				position: absolute;
				bottom: 20px;
				left: 50%;
				transform: translateX(-50%);
				padding: 12px 24px;
				font-size: 16px;
				border-radius: 12px;
				background-color: #1976d2;
				color: white;
				border: none;
				cursor: pointer;
				z-index: 10;
			}
		</style>
	</head>
	<body>
		<!-- Social icons -->
		<div id="socialContainer">
			<div class="row">
				<img id="facebookIcon" class="social-icon" src="./icons/facebook.png" />
				<img id="linkedinIcon" class="social-icon" src="./icons/linkedin.png" />
			</div>
			<div class="row">
				<img id="phoneIcon" class="social-icon" src="./icons/call.png" />
				<img id="mailIcon" class="social-icon" src="./icons/mail.png" />
			</div>
		</div>

		<!-- Browser AR with MindAR -->
		<a-scene
			mindar-image="imageTargetSrc: https://abusaeed-shuvo.github.io/mvcard/targets/targets.mind; uiLoading:false; uiScanning:false;"
			color-space="sRGB"
			renderer="colorManagement:true, physicallyCorrectLights"
			vr-mode-ui="enabled:false"
			device-orientation-permission-ui="enabled:false"
		>
			<a-assets>
				<a-asset-item
					id="cardModel"
					src="https://abusaeed-shuvo.github.io/mvcard/models/model.glb"
				></a-asset-item>
			</a-assets>

			<a-camera position="0 0 0"></a-camera>

			<a-entity mindar-image-target="targetIndex:0">
				<a-entity
					gltf-model="#cardModel"
					scale="0.5 0.5 0.5"
					position="0 0 0"
				></a-entity>
			</a-entity>
		</a-scene>

		<!-- Device AR fallback -->
		<model-viewer
			id="arCard"
			src="https://abusaeed-shuvo.github.io/mvcard/models/model.glb"
			alt="AR Business Card"
			ar
			ar-modes="webxr scene-viewer quick-look"
			camera-controls
			auto-rotate
			style="width: 100%; height: 100vh"
		>
			<button slot="ar-button" id="arButton">View in AR</button>
		</model-viewer>

		<script>
			const isMobileAR = /Android|iPhone|iPad/i.test(navigator.userAgent);
			const modelViewer = document.getElementById("arCard");
			const mindARScene = document.querySelector("a-scene");

			if (isMobileAR) {
				// Show model-viewer, hide MindAR
				modelViewer.style.display = "block";
				mindARScene.style.display = "none";
			} else {
				// Show MindAR, hide model-viewer
				modelViewer.style.display = "none";
				mindARScene.style.display = "block";
			}
			const socialContainer = document.getElementById("socialContainer");

			// Show social icons after model loads
			modelViewer.addEventListener("load", () => {
				socialContainer.classList.add("show");
			});

			// Social icon actions
			const actions = {
				facebookIcon: () =>
					window.open("https://www.facebook.com/yourusername", "_blank"),
				linkedinIcon: () =>
					window.open("https://www.linkedin.com/in/yourusername", "_blank"),
				phoneIcon: () => (window.location.href = "tel:+8801234567890"),
				mailIcon: () => (window.location.href = "mailto:youremail@example.com"),
			};

			Object.keys(actions).forEach((id) => {
				const el = document.getElementById(id);
				el.addEventListener("click", actions[id]);
				el.addEventListener("touchstart", actions[id]);
			});
		</script>
	</body>
</html>
