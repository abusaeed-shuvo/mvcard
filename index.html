<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Hybrid AR Business Card</title>

		<!-- MindAR -->
		<script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-three.prod.js"></script>

		<!-- Model Viewer -->
		<script
			type="module"
			src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"
		></script>

		<style>
			html,
			body {
				margin: 0;
				overflow: hidden;
				height: 100%;
				background: black;
			}

			#container {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				overflow: hidden;
			}

			#model-viewer {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				display: none;
				pointer-events: none;
				opacity: 0;
				transition: opacity 0.3s ease;
				z-index: 2;
			}

			#model-viewer.show {
				display: block;
				opacity: 1;
			}

			#info {
				position: fixed;
				bottom: 10px;
				left: 50%;
				transform: translateX(-50%);
				background: rgba(0, 0, 0, 0.6);
				color: white;
				padding: 6px 12px;
				border-radius: 8px;
				font-family: sans-serif;
				z-index: 3;
			}
		</style>
	</head>

	<body>
		<div id="container"></div>

		<model-viewer
			id="model-viewer"
			src="https://abusaeed-shuvo.github.io/mvcard/models/model.glb"
			alt="AR Business Card"
			camera-controls
			auto-rotate
			ar
			ar-modes="webxr scene-viewer quick-look"
		></model-viewer>

		<div id="info">Point your camera at the marker</div>

		<script>
			async function startAR() {
				const container = document.getElementById("container");

				const mindarThree = new window.MINDAR.IMAGE.MindARThree({
					container,
					imageTargetSrc:
						"https://abusaeed-shuvo.github.io/mvcard/targets/targets.mind",
				});

				const { renderer, scene, camera } = mindarThree;
				const anchor = mindarThree.addAnchor(0);

				// Make sure renderer canvas is visible
				renderer.domElement.style.position = "absolute";
				renderer.domElement.style.top = "0";
				renderer.domElement.style.left = "0";
				renderer.domElement.style.width = "100%";
				renderer.domElement.style.height = "100%";
				container.appendChild(renderer.domElement);

				const modelViewer = document.getElementById("model-viewer");
				const info = document.getElementById("info");

				anchor.onTargetFound = () => {
					console.log("âœ… Marker found");
					modelViewer.classList.add("show");
					info.textContent = "Marker found âœ…";
				};

				anchor.onTargetLost = () => {
					console.log("âŒ Marker lost");
					modelViewer.classList.remove("show");
					info.textContent = "Point your camera at the marker";
				};

				await mindarThree.start();
				console.log("ðŸŽ¥ MindAR started");

				renderer.setAnimationLoop(() => {
					renderer.render(scene, camera);
				});
			}

			startAR().catch((err) => {
				console.error("AR start error:", err);
			});
		</script>
	</body>
</html>
